# Decider Role Guide

The **Decider** agent acts as the triage center for the Jules workflow. It processes raw events emitted by Observers and converts them into structured requirements for Planner and Implementer agents.

## Purpose

The Decider's goal is to reduce noise and provide clear, actionable instructions. It consolidates related events (e.g., multiple lint errors from the same file) into single, cohesive requirements, ensuring that downstream agents work on well-defined tasks.

## Inputs

- **Pending Events**: YAML files located in `.jules/exchange/events/pending/`. These are generated by Observers.
- **Narrator Summary**: The `.jules/exchange/changes.yml` file for context on recent changes.

## Outputs

- **Requirements**: YAML files located in `.jules/exchange/requirements/`.
- **Decided Events**: Moves processed event files from `pending/` to `.jules/exchange/events/decided/`.

## Execution

The Decider is executed via the CLI:

```bash
jlo run decider
```

### Process Flow

1. **Event Discovery**:
   - Scans `.jules/exchange/events/pending/` for new event files.
   - Reads the `source_role` and content of each event.

2. **Analysis & Triage**:
   - Groups related events based on similarity (e.g., same file, same error type).
   - Determines if an event warrants action (ignoring noise or false positives).
   - Assigns a priority and label to the requirement.

3. **Requirement Generation**:
   - Creates a new requirement file in `.jules/exchange/requirements/`.
   - The requirement includes:
     - `title`: A concise summary of the task.
     - `label`: A category label (e.g., `bug`, `refactor`).
     - `priority`: `low`, `medium`, or `high`.
     - `source_events`: List of event IDs that triggered this requirement.
     - `deep_analysis_reason`: If complex, triggers Planner.

4. **Cleanup**:
   - Moves the source event files to `.jules/exchange/events/decided/`.
   - Updates the event files with the `issue_id` (requirement ID) for traceability.

## Schema (`issue.yml`)

The requirement output follows the schema defined in `.jules/layers/decider/schemas/issue.yml`.

## Tasks

The Decider uses tasks defined in `.jules/layers/decider/tasks/` to structure its reasoning. The main prompt, `decider_prompt.j2`, includes these tasks to guide the agent.

## Troubleshooting

- **No Requirements Created**: If events are deemed low priority or duplicates, the Decider might archive them without creating a requirement.
- **Stuck Events**: If an event file remains in `pending/` after a run, check the logs for validation errors or file permission issues.
