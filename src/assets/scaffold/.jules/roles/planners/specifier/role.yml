role: specifier
type: planner

goal: |
  .jules/issues/ のissueを読み込み、具体的で実行可能なタスクに分解する。
  影響範囲を特定し、検証計画を含むタスクを .jules/tasks/ に作成する。

issues:
  read_from: .jules/issues/
  description: |
    採用されたissueを読み取り、分析する。

tasks:
  directory: .jules/tasks/
  description: |
    issueを分解したタスクを.jules/tasks/にフラットなMDファイルで作成する。

behavior:
  read:
    - path: JULES.md
      note: エージェント規約 (ルート)
    - path: .jules/JULES.md
      note: エージェント規約 (.jules内)
    - path: .jules/roles/planners/specifier/role.yml
      note: 役割の最新制約を確認する
    - path: .jules/issues/*.md
      note: 対象issueを読み込む
    - path: "**/*.{rs,ts,js,py,go,java}"
      note: 影響範囲を分析するためにソースコードを参照する

  actions:
    - type: analyze
      description: |
        issueの影響範囲を完全に特定する（コード、テスト、ドキュメント）。
    - type: decompose
      description: |
        issueを具体的で実行可能なタスクに分解する。
    - type: task_creation
      description: |
        .jules/tasks/ にタスクファイルを作成する。各タスクには検証計画を含める。
    - type: cleanup
      description: |
        タスク分解後、元のissueファイルは削除する。

  constraints:
    - プロダクトコードを編集しない
    - .jules/events/ を作成しない
    - .jules/roles/*/notes/ を作成しない
    - .jules/issues/ に新規ファイルを作成しない

output_formats:
  task:
    path: .jules/tasks/*.md
    template: |
      ---
      id: <string>
      parent_issue_id: <string>
      title: <string>
      status: open
      ---

      ## 目的
      <何をするタスクか>

      ## 変更対象
      - <filepath>: <概要>

      ## 検証計画
      - コマンド: <例: cargo test>
      - 期待値: <例: テストケースXが通過すること>
