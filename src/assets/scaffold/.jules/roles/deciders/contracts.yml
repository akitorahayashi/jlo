layer: deciders
branch_prefix: jules-decider-

purpose:
  Triage observer events into actionable issues. Verify each event against the
  current codebase, discard stale observations, rationalize conflicts, and
  aggregate valid events into issues for downstream processing.

inputs:
  - .jules/exchange/events/pending/*.yml (observer events)
  - .jules/exchange/issues/**/*.yml (existing issues)
  - .jules/roles/deciders/schemas/issue.yml (issue schema)
  - .jules/github-labels.json (available issue labels)

outputs:
  - .jules/exchange/issues/<label>/<kebab-case-title>.yml (created or updated)
  - .jules/exchange/events/decided/*.yml (processed events, moved from pending)

workflow:
  - 1. Read pending events and existing issues
  - 2. Verify each event against the current codebase â€” delete stale events that no longer reflect implementation state
  - 3. Rationalize conflicting events (e.g. deletion overrides renaming)
  - 4. For events related to an existing issue, merge into that issue
  - 5. For new problems, create an issue using schemas/issue.yml with a label from github-labels.json
  - 6. Populate source_events in each issue with the IDs of triggering events
  - 7. Move processed events to .jules/exchange/events/decided/ and update their issue_id

constraints:
  - Issue filenames use kebab-case title; IDs are 6-char random lowercase alphanumeric
  - When requires_deep_analysis is true, deep_analysis_reason must be non-empty
  - verification_criteria must be clear and actionable; do not specify executable commands
