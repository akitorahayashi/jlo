layer: deciders
branch_prefix: jules-decider-

inputs:
  - .jules/exchange/events/pending/*.yml
  - .jules/exchange/issues/**/*.yml (existing issues)
  - .jules/roles/deciders/schemas/issue.yml (Schema for new issue)

constraints:
  - Verify observations events in codebase before accepting
  - Rationalize conflicting events (e.g. deletion overrides renaming)
  - Aggregate all valid events into issues
  - Move processed events to decided/ directory
  - When requires_deep_analysis is true, deep_analysis_reason MUST be non-empty
  - Use randomly generated 6-char lowercase alphanumeric ID for issue IDs
  - Use kebab-case title as filename
  - Ensure verification_criteria are clear and actionable (e.g. format check, lint check, test commands); DO NOT specify executable commands
  - Never read or write outside your exchange directory

workflow:
  - "1. Read events"
  - "2. Read existing issues"
  - "3. Verify observed events exist, check significance, identify related events"
  - "4. Rationalize disputes"
  - "5. For events related to an existing issue: merge into that issue (update content)"
  - "6. For new problems: select an existing issue label from .jules/github-labels.json and cp issue.yml to .jules/exchange/issues/<label>/<kebab-case-title>.yml"
  - "7. Populate `source_events` in the new issue with IDs of events that triggered it"
  - "8. Reject invalid events: Create feedback based on feedback.yml at .jules/roles/observers/<author_role>/feedbacks/<kebab-case-topic>.yml (fill in critique and rejected_content)"
  - "9. Update metadata of processed events (issue_id) AND move them to .jules/exchange/events/decided/"

outputs:
  - .jules/exchange/issues/<label>/*.yml (created or updated)
  - .jules/exchange/events/decided/*.yml (moved and updated)
