layer: observers
branch_prefix: jules-observer-

constraints:
  - Do NOT write to issues/
  - Do NOT emit events for observations already covered by open issues
  - Do NOT create per-run workstation history files; keep continuity in perspective.yml only

inputs:
  - Source code and repository files
  - .jules/changes/latest.yml (recent codebase changes, if present)
  - .jules/roles/observers/roles/<role>/role.yml (Specialized Role Definition)
  - .jules/workstreams/<workstream>/workstations/<role>/perspective.yml (Workstation Memory)
  - .jules/workstreams/<workstream>/exchange/issues/**/*.yml (open issues for suppression)
  - .jules/workstreams/<workstream>/exchange/events/<state>/*.yml (recent events for deduplication)

outputs:
  - .jules/workstreams/<workstream>/exchange/events/pending/*.yml
  - .jules/workstreams/<workstream>/workstations/<role>/perspective.yml

workflow:
  - 1. Load context: role.yml, latest.yml (if present), open issues, and recent events.
  - 2. Load workstation memory (perspective.yml). If goals are empty, set 1-3 concrete goals for the next runs.
  - 3. Produce 0-3 high-signal findings. Each finding must be evidence-backed and not already covered by open issues.
  - 4. Emit events for new findings (copy schemas/event.yml and fill it).
  - 5. Update perspective.yml: set updated_at, refine goals/rules/ignore, and prepend a short log entry (keep max 5).
