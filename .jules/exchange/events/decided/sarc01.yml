schema_version: 1

# Metadata
id: "sarc01"
requirement_id: "t4m8p2" # ID of the requirement that processed this event (empty if unprocessed)
created_at: "2026-02-20"
author_role: "structural_arch" # e.g. taxonomy
confidence: "high"

# Content
title: "Test Logic Pollution in `src/app/commands/run`"
statement: |
  The `src/app/commands/run` module duplicates core test double definitions (`TestGit`, `TestGitHub`) and includes mock execution logic (`src/app/commands/run/mock/`) within the production codebase. This violates DRY, complicates maintenance by having multiple sources of truth for test doubles, and pollutes the application layer with test-specific code.

# Evidence supporting the observation
# For multi-file events, add multiple list items.
evidence:
  - path: "src/app/commands/run/mod.rs"
    loc:
      - "215"
    note: "Defines `struct TestGit`, duplicating `src/testing/ports/git_stub.rs`."
  - path: "src/app/commands/run/mod.rs"
    loc:
      - "337"
    note: "Defines `struct TestGitHub`, duplicating `src/testing/ports/github_stub.rs`."
  - path: "src/app/commands/run/mock/mock_execution.rs"
    loc:
      - "1"
    note: "Contains `MockExecutionService` (mock logic in app code)."
  - path: "src/app/commands/run/mock/mod.rs"
    loc:
      - "1"
    note: "Exposes mock logic."
