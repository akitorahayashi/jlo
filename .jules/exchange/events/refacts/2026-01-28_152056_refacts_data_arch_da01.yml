schema_version: 1

# Metadata
id: "2026-01-28_152056_refacts_data_arch_da01"
created_at: "2026-01-28"
author_role: "data_arch"
category: "refacts"
confidence: "high"

# Content
title: "Decouple EnvSpec Domain Model from Serialization"
statement: |
  The `EnvSpec` struct in `src/domain/setup.rs` is used as both a domain object and a DTO for TOML deserialization. It carries `serde` attributes, violating Boundary Sovereignty (Data structures should be independent of logic/UI/Infrastructure). A dedicated `EnvSpecDto` should be introduced for the infrastructure layer (serialization), leaving the domain `EnvSpec` pure.

evidence:
  - path: "src/domain/setup.rs"
    loc: "EnvSpec struct definition"
    note: "Struct derives Deserialize and uses serde attributes."
  - path: "src/domain/setup.rs"
    loc: "ComponentMeta struct definition"
    note: "DTO uses the domain object EnvSpec directly."
  - path: "src/services/catalog.rs"
    loc: "EmbeddedCatalog::new"
    note: "Deserializes TOML directly into ComponentMeta which uses EnvSpec."

tags:
  - "architecture"
  - "coupling"
  - "domain-purity"
  - "serde"
