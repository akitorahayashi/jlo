schema_version: 1

# Metadata
id: "2026-01-28_152238_refacts_qa_genfs"
created_at: "2026-01-28"
author_role: "qa"
category: "refacts"
confidence: "high"

# Content
title: "Decouple Generator::merge_env_toml from filesystem"
statement: |
  The `merge_env_toml` method in `Generator` service directly accesses the filesystem to read existing configuration.
  This makes unit testing dependent on filesystem state and `tempfile`, violating the principle of Environmental Invariance.
  It should accept the content string instead.

evidence:
  - path: "src/services/generator.rs"
    loc: "merge_env_toml"
    note: "Method takes Option<&Path> and performs file I/O internally."

tags:
  - "testing"
  - "refactoring"
  - "quality"
