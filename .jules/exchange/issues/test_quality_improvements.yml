schema_version: 2

# Metadata
fingerprint: "test_quality_improvements"
id: "test_quality_improvements"
category: "tests"
priority: "medium"
status: "open"
requires_deep_analysis: false
deep_analysis_reason: ""
sources:
  - "2025-05-22_120002_tests_qa_003"
  - "2026-01-28_152238_tests_qa_domset"

# Content
title: "Improve Test Quality and Coverage"
summary: "Refactor integration tests to follow Diagnostic Specificity and add missing unit tests for setup domain."

affected_areas:
  - "tests/cli_commands.rs"
  - "src/domain/setup.rs"

constraints: []

risks: []

problem: |
  1. Integration tests like `init_creates_jules_directory` assert too many logical conditions in a single test case (Diagnostic Specificity violation), making failures hard to diagnose.
  2. The `src/domain/setup.rs` module lacks unit tests, despite containing logic like `Component::from_meta`.

impact: |
  Test failures are harder to debug.
  Domain logic logic is unprotected against regressions.

desired_outcome: |
  Integration tests should be broken down into smaller, more focused tests where possible (or have better assertion messages).
  Unit tests should be added to `src/domain/setup.rs` to cover all logic.

acceptance_criteria:
  - "`init_creates_jules_directory` and similar tests are refactored for specificity."
  - "`src/domain/setup.rs` has comprehensive unit tests."
