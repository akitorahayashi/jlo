schema_version: 2

# Metadata
id: "o8p9q0"
source_events:
  - "d4e5f6"
  - "g7h8i9"
  - "qa1234"
  - "qa5678"
title: "Optimize Testing Strategy"
label: "tests"
priority: "medium"
summary: "Shift testing left by adding unit tests for domain logic, reducing redundant integration tests, and validating workflows functionally."

# Content
goal: |
  Create a balanced testing pyramid by introducing fast unit tests for domain logic and optimizing integration tests to be faster and less redundant.

problem: |
  1. Core domain logic in `src/domain/` lacks unit tests.
  2. Integration tests (`cli_commands.rs`, `api_coverage.rs`) are redundant and slow, re-initializing git repos for every case.
  3. Workflow generation tests verify string containment but not functional validity.

impact: |
  Slow feedback loops discourage running tests locally. Lack of unit tests makes refactoring risky.

desired_outcome: |
  - Unit tests cover >80% of domain logic.
  - Integration tests reuse context where possible or use lighter fixtures.
  - Redundant test scenarios are removed.
  - Generated workflows are validated against a schema or dry-run.

constraints: []
risks: []

# Specifics
affected_areas:
  - "src/domain/"
  - "tests/"

acceptance_criteria:
  - "Unit tests exist for `RequirementHeader` and other domain entities."
  - "`TestContext` overhead is reduced."
  - "Test suite execution time is reduced by 50%."
  - "Workflow tests validate structure/schema."

verification_criteria:
  - "Run `cargo test` and check execution time."
  - "Check coverage report for `src/domain/`."

requires_deep_analysis: false
deep_analysis_reason: ""
