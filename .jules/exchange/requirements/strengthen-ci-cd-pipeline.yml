schema_version: 2

# Metadata
id: "s3t5u7"
source_events:
  - "a1b2c3"
  - "a7b8c9"
  - "d1e2f3"
  - "g4h5i6"
title: "Strengthen CI/CD Pipeline"
label: "refacts"
priority: "high"
summary: "Improve CI rigor with higher coverage, provenance, and comprehensive linting/verification."

# Content
goal: |
  Harden the CI/CD pipeline to ensure higher code quality, verify the integrity of generated workflows, and secure the release process.

problem: |
  1. Low test coverage threshold (40%) allows untested code to pass.
  2. Generated workflows in `.tmp/` are linted but never compared against committed workflows in `.github/workflows/`, allowing drift.
  3. Manual workflows (e.g., `release.yml`) are excluded from linting.
  4. Release artifacts lack SLSA provenance or signing.

impact: |
  These gaps increase the risk of introducing bugs, security vulnerabilities (via unverified artifacts), and drift between source code and CI configuration.

desired_outcome: |
  - Code coverage threshold increased (e.g., to 70% or 80%).
  - CI step verifies that generated workflows match committed workflows.
  - All workflow files are linted.
  - Release process includes provenance generation and signing.

constraints: []
risks: []

# Specifics
affected_areas:
  - ".github/workflows/"
  - "src/app/commands/workflow/generate.rs"

acceptance_criteria:
  - "Coverage failure threshold is at least 70%."
  - "CI fails if `jlo workflow generate` produces changes vs `.github/workflows/`."
  - "`actionlint` runs on all `.yml` files in `.github/workflows/`."
  - "Release artifacts have associated provenance."

verification_criteria:
  - "Run CI with low coverage and verify failure."
  - "Run CI with modified workflow source and verify failure."
  - "Check release artifacts for provenance."

requires_deep_analysis: false
deep_analysis_reason: ""
