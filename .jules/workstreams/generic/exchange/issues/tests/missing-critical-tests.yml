schema_version: 2
id: s6qs2c
source_events:
  - b3k1m4
  - 7f25d3
  - 45fd74
  - n7x9p2
  - s3m8k1
title: Add missing unit tests for critical logic
label: tests
priority: medium
summary: Add missing unit tests for critical logic
problem: |
  Critical validation logic in doctor checks (structure, schema), asset parsing, and narrator logic lacks unit tests.
impact: High risk of regressions in core framework functionality.
desired_outcome: Unit tests added for structural_checks, schema_checks, read_enum_values, and narrator logic.
constraints: []
risks: []
affected_areas:
  - src/app/commands/doctor/structure.rs
  - src/services/assets/scaffold_assets.rs
  - src/app/commands/run/narrator.rs
  - src/app/commands/doctor/schema.rs
acceptance_criteria:
  - Add unit tests for doctor/structure.rs.
  - Add unit tests for services/assets/scaffold_assets.rs.
  - Add unit tests for narrator.rs (execute, collect_git_context).
  - Add unit tests for doctor/schema.rs (validate_event, validate_issue, etc.).
verification_commands:
  - cargo test src/app/commands/doctor/structure.rs
  - cargo test src/services/assets/scaffold_assets.rs
  - cargo test src/app/commands/run/narrator.rs
  - cargo test src/app/commands/doctor/schema.rs
requires_deep_analysis: false
deep_analysis_reason: ''
