schema_version: 2

# Metadata
id: "m3n4q5"
source_events:
  - "e7f2a1"
title: "Replace Untyped Domain Errors"
label: "refacts"
priority: "medium"
summary: "Replace `Result<Self, String>` with typed errors in domain parsing."

# Content
problem: |
  Domain entities `RunConfig` and `WorkstreamSchedule` return `Result<Self, String>` from their `parse_toml` methods.
  This "stringly-typed" error handling erases error context and makes it difficult for callers to handle specific failure modes programmatically.

impact: |
  - Callers cannot distinguish between different types of parsing errors without parsing the error string.
  - Violates the principle "Errors are part of the contract".
  - Poor developer experience when debugging or handling errors upstream.

desired_outcome: |
  `parse_toml` methods should return `Result<Self, AppError>` (or a specific domain error type) instead of `String`.
  The error type should preserve the underlying error cause (e.g., `toml::de::Error`).

constraints: []
risks: []

# Specifics
affected_areas:
  - "src/domain/run_config.rs"
  - "src/domain/schedule.rs"
  - "src/app/commands/doctor/structure.rs"
  - "src/app/commands/run/config.rs"
  - "src/services/workstream_schedule_filesystem.rs"

acceptance_criteria:
  - "`RunConfig::parse_toml` returns a typed error."
  - "`WorkstreamSchedule::parse_toml` returns a typed error."
  - "Callers are updated to handle the new error type."

verification_commands:
  - "cargo test domain"
  - "cargo test app::commands"

# Analysis Flags
requires_deep_analysis: false
deep_analysis_reason: ""
