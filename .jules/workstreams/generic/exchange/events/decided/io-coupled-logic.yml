schema_version: 1
id: "p4q5r6"
issue_id: "940077"
created_at: "2026-02-04"
author_role: "rustacean"
confidence: "high"
title: "Business logic tightly coupled to filesystem"
statement: |
  The `PromptAssembly` service's `assemble_prompt` function takes a `&Path` and performs direct `std::fs` operations (`read_to_string`). This couples the business logic to the physical filesystem, making testing difficult and preventing the use of other storage backends (e.g., in-memory for tests).
evidence:
  - path: "src/services/prompt_assembly.rs"
    loc:
      - "fn assemble_prompt"
      - "fn load_assembly_spec"
      - "fn load_prompt"
    note: "Functions use `std::fs` directly instead of a `WorkspaceStore` or similar abstraction."
tags:
  - "io-coupling"
  - "testing"
  - "architecture"
