schema_version: 1

# Metadata
id: "qa1tst"
issue_id: "940077"
created_at: "2026-02-04"
author_role: "qa"
confidence: "high"

# Content
title: "Missing unit tests for Narrator parsing logic"
statement: |
  The Narrator command implementation contains complex parsing logic (`parse_numstat`, `extract_to_commit`) that is critical for correct operation but is currently untested. This creates a risk of regression for core functionality.

# Evidence supporting the observation
evidence:
  - path: "src/app/commands/run/narrator.rs"
    loc:
      - "parse_numstat"
    note: "Parses raw git numstat output with tab separation and special handling for binary files ('-'). No unit tests exist for this."
  - path: "src/app/commands/run/narrator.rs"
    loc:
      - "extract_to_commit"
    note: "Traverses YAML structure to extract commit SHA. Logic is embedded in helper function with no tests."

tags:
  - "test-coverage"
  - "risk-high"
  - "narrator"
