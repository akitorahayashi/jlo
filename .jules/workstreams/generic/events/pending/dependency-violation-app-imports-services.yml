schema_version: 1

# Metadata
id: "depv01"
issue_id: ""
created_at: "2026-02-01"
author_role: "structural_arch"
confidence: "high"

# Content
title: "Dependency Violation: App Layer Imports Services Directly"
statement: |
  The `app` layer (commands) directly imports concrete implementations from `services`, bypassing the `ports` abstraction. This violates the dependency inversion principle of the hexagonal architecture, where the core (app/domain) should only depend on ports, and services (adapters) should implement those ports.

# Evidence supporting the observation
evidence:
  - path: "src/app/commands/update.rs"
    loc:
      - "use crate::services::EmbeddedRoleTemplateStore;"
    note: "Command implementation depends on concrete service instead of port."
  - path: "src/app/commands/init.rs"
    loc:
      - "use crate::services::{manifest_from_scaffold, write_manifest};"
    note: "Command implementation depends on concrete service logic."

tags:
  - "architecture"
  - "dependency-inversion"
  - "coupling"
