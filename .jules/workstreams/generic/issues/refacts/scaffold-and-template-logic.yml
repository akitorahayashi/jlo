schema_version: 2

# Metadata
id: "s5j3k8"
source_events:
  - "m4n2b8"
  - "da0003"
title: "Scaffold and Template Logic Refactoring"
label: "refacts"
priority: "medium"
summary: "EmbeddedRoleTemplateStore misnamed, mixes scaffold/template responsibilities; ScaffoldManifest lacks cohesion."

# Content
problem: |
  1. `EmbeddedRoleTemplateStore` serves both "Scaffold" (immutable .jules structure) and "Templates" (blueprints for new roles). This violates the Single Responsibility Principle and creates a vocabulary collision where "Template" implies dynamic creation but is used for static structure.
  2. `ScaffoldManifest` service mixes domain logic (schema, validation) with low-level infrastructure concerns (hashing, file I/O), resulting in low cohesion.

impact: |
  The vocabulary mismatch causes confusion for developers (e.g., "Why does the TemplateStore serve the README?"). Low cohesion in `ScaffoldManifest` makes it harder to change the manifest format or hashing algorithm independently of I/O logic.

desired_outcome: |
  1. Split `EmbeddedRoleTemplateStore` into `ScaffoldService` (for static assets) and `TemplateService` (for role/workstream blueprints).
  2. Refactor `ScaffoldManifest` to be a pure domain entity/service. Move I/O and hashing to appropriate infrastructure adapters or utility modules.

constraints: []
risks: []

# Specifics
affected_areas:
  - "src/services/embedded_role_template_store.rs"
  - "src/services/scaffold_manifest.rs"

acceptance_criteria:
  - "New `ScaffoldService` handles `.jules/` structure assets."
  - "`EmbeddedRoleTemplateStore` (or new `TemplateService`) handles only role/workstream templates."
  - "`ScaffoldManifest` struct is decoupled from `std::fs` calls."

verification_commands:
  - "cargo check"
  - "cargo test"

# Analysis Flags
requires_deep_analysis: false
deep_analysis_reason: ""
